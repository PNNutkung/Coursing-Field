{% extends 'ui/navbar.html' %}
{% load staticfiles %}

{% block script %}
<script type="text/javascript">

function checkPassword(str)
{
  var re = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{6,}$/;
  return re.test(str);
}

function checkForm(form)
{
  re = /^\w+$/;
  if(!re.test(form.username.value)) {
    form.username.setCustomValidity("Username must contain only letters, numbers and underscores!");
    return false;
  }

  reemail = /^[^@]+@[^@]+\.[^@]+$/;
  if(!reemail.test(form.email.value)) {
    form.email.setCustomValidity('Your entered email has wrong format.')
    return false;
  }

  if(form.password.value == form.confirm_password.value) {
    if(!checkPassword(form.password.value)) {
      form.password.setCustomValidity("The password you have entered is not valid!");
      return false;
    }
  } else {
    form.password.setCustomValidity("Error: Please check that you've entered and confirmed your password!");
    return false;
  }

  rename = /^[A-Za-z]+$/;
  if(!rename.test(form.lastname.value)) {
    form.firstname.setCustomValidity('Your entered firstname has wrong format.');
    return false;
  }
  if(!rename.test(form.firstname.value)) {
    form.lastname.setCustomValidity('Your entered lastname has wrong format.');
    return false;
  }
  return true;
}

</script>
{% endblock %}

{% block body %}
<div class="container" id="login-container">
  {% if message%}
    <div class="alert alert-danger" role="alert">{{message}}</div>
  {% endif %}
  <div class="panel panel-success">
    <div class="panel-heading">Register</div>
    <div class="panel-body">
      <form action="{% url 'account:register' %}" onsubmit="return checkForm(this);" role="form" method="POST">
          {% csrf_token %}
          <div class="form-group">
            <label for="username">Username:</label>
            <input id="username" class="form-control" type="text" name="username" placeholder="Enter a username." required oninput="setCustomValidity('')"/>
          </div>
          <div class="form-group">
            <label for="email">Email:</label>
            <input id="email" class="form-control" type="text" name="email" placeholder="Enter an email." required oninput="setCustomValidity('')"/>
          </div>
          <div class="form-group">
            <label for="password">Password:</label>
            <input id="password" class="form-control" type="password" name="password" placeholder="Enter a password." required oninput="setCustomValidity('')"/>
          </div>
          <div class="form-group">
            <label for="confirm_password">Confirm Password:</label>
            <input id="confirm_password" class="form-control" type="password" name="confirm_password" placeholder="Enter a confirm password." required oninput="setCustomValidity('')"/>
          </div>
          <div class="form-group">
            <label for="firstname">Firstname:</label>
            <input id="firstname" class="form-control" type="text" name="firstname" placeholder="Enter your firstname." required oninput="setCustomValidity('')"/>
          </div>
          <div class="form-group">
            <label for="lastname">Lastname:</label>
            <input id="lastname" class="form-control" type="text" name="lastname" placeholder="Enter your lastname." required oninput="setCustomValidity('')"/>
          </div>
          <div class="form-group">
            <label for="bday">Birth Date:</label>
            <input class="form-control" id="bday" type='date' name='birthday' required/>
          </div>
          <div class="form-group">
            <label for="gender">Gender:</label>
            <select id="gender" class="form-control" name='gender' required>
              <option value="">Select Gender</option>
              <option value="M">Male</option>
              <option value="F">Female</option>
              <option value="O">Other</option>
            </select>
          </div>
          <input class="btn btn-block btn-success" type="submit" value="Register"/>
      </form>
    </div>
  </div>
</div>
{% endblock %}
