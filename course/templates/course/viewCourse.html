<!DOCTYPE>
<html>
    <header>
        <meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8">
        <title>{{course.courseName}}</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <style media="screen">
            .center-cropped {
                height: 350px;
                width: auto;
                background-position: center center;
                background-size: cover;
            }
            .list-right {
                padding-left: 6px;
                padding-top: 6px;
                padding-bottom: 6px;
            }
            ul {
                list-style-type: none;
                padding-left: 0px;
            }
        </style>
    </header>
    <body>
        <div class="container">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <h1>{{course.courseName}}</h1>
                <p>Rating </p>
                <p>Instructed by {{course.owner}}</p>
                <p><b>Category:</b> {{inCategory}}</p>
            </div>
        <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
            <div class="center-cropped" style="background-image: url({{course.courseThumbnail.url}});"></div>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            <span><h3><b>฿ {{course.coursePrice}}</b></h3></span>
            {% if hasTakenCourse %}
                <a class="btn btn-success" href={% url 'watchvideo:show_contents_in_tabs' courseID=course.courseID %}>Learn Now</a>
            {% else %}
                <button type='button' class='btn btn-block btn btn-success' data-toggle='modal' data-target='#confirmPurchaseModal'>Take This Course</button>

                <div id="confirmPurchaseModal" class="modal fade" role="dialog">
                    <div class="modal-dialog">
                        {% comment %}Modal content{% endcomment %}
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">
                                    <span aria-hidden="true">&times;</span>
                                    <span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabel">
                                    Confirm purchasing of {{course.courseName}}
                                </h4>
                            </div>
                            <div class='modal-body'>
                                <form action={% url 'takecourse:take_course' courseID=course.courseID %} method="POST">
                                    {% csrf_token %}
                                    <table class="list">
                                        <tr class="list-item">
                                            <td class="list-left"><b>Course name</b></td>
                                            <td class="list-right">{{course.courseName}}</td>
                                        </tr>
                                        <tr class="list-item">
                                            <td class="list-left"><b>Insert coupon</b></td>
                                            <td class="list-right"><input type="text" name="coupon"></td>
                                        </tr>
                                        <tr class="list-item">
                                            <td class="list-left"><b>Your balance</b></td>
                                            <td class="list-right">{{userWithProfile.profile.balance}}</td>
                                        </tr>
                                        <tr class="list-item">
                                            <td class="list-left"><b>You Pay</b></td>
                                            <td class="list-right">฿ {{course.coursePrice}}</td>
                                        </tr>
                                        <tr class="list-item">
                                            <td class="list-left"><b>Left balance</b></td>
                                            <td class="list-right">฿ {{leftBalance}}</td>
                                        </tr>
                                    </table>
                                    <input type="submit" class="btn btn-block btn-primary" value="Confirm">
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
            <table>
                <tr>
                    <td>
                        <span>Lectures</span>
                    </td>
                    <td>
                        <span><b>{{numberOfLectures}}</b></span>
                    </td>
                </tr>
            </table>
        </div>
        <div class="col-sm-12 col-sm-12 col-md-12 col-lg-12">
            <h2><b>Course description</b></h2>
            <p>
                {{course.courseDesc}}
            </p>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <h2><b>Reviews</b></h2>
            {% if averageRating > 0 %}
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                <span class="hm">Average Rating</span>
                <div class="average-rate">
                    <h1><b>{{averageRating}}</b></h1>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
                <div class="rate-list-title">
                    <span><b>Details</b></span>
                </div>
                <ul>
                    {% for rateLevel in reviewRateLevel %}
                    <li>
                        <div class="row">
                            <span class="col-xs-12 col-sm-2 col-md-2 col-lg-2">{{rateLevel.star}}</span>
                            <div class="col-xs-8 col-sm-4 col-md-4 col-lg-4">
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{rateLevel.percentage}}%;">
                                    </div>
                                </div>
                            </div>
                            <span class="col-xs-4 col-sm-2 col-md-2 col-lg-2">{{rateLevel.percentage}}%</span>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% if reviews %}
            <ul class="reviews-list">
                {% for review in reviews %}
                    <li class="review">
                        <div class="info-container">
                            <div class="avatar">
                                <img src="{{review.owner.profile.profilePicture.url}}" alt="{{review.owner}}\'s avatar" />
                            </div>
                        </div>
                        <div class="user-details">
                            <ul>
                                <li class="username ellipsis">{{review.owner.profile.first_name}} {{review.owner.profile.last_name}}</li>
                                <li class="review-create">{{review.reviewDate}}</li>
                            </ul>
                        </div>
                        <div class="rating-container">
                            {{review.rating}}
                        </div>
                        <div class="comment-container">
                            <p>
                                {{review.reviewDesc}}
                            </p>
                        </div>
                    </li>
                {% endfor %}
            </ul>
            {% endif %}
            <div class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
                <nav aria-label="Page navigation">
                    <ul class="pager">
                        <li {% if not reviews.has_previous %} class="disabled" {% endif %}><a {% if reviews.has_previous %}href="?page={{ reviews.previous_page_number }}" {% endif %} aria-label="Previous">Previous</a></li>
                        <li {% if not reviews.has_next %} class="disabled" {% endif %}><a {% if reviews.has_next %}href="?page={{ reviews.next_page_number }}" {% endif %} aria-label="Next">Next</a></li>
                    </ul>
                </nav>
            </div>
            {% else %}
            <span><h2>There is no review.</h2></span>
            {% endif %}
        </div>
    </div>
    </body>
</html>
